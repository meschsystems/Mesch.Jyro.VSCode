{
  "Variable Declaration": {
    "prefix": "var",
    "body": [
      "var ${1:name} = ${2:value}"
    ],
    "description": "Declare a variable"
  },
  "Variable Declaration with Type": {
    "prefix": "vart",
    "body": [
      "var ${1:name} : ${2|number,string,boolean,object,array|} = ${3:value}"
    ],
    "description": "Declare a variable with type annotation"
  },
  "If-Then-End": {
    "prefix": "if",
    "body": [
      "if ${1:condition} then",
      "\t$0",
      "end"
    ],
    "description": "If statement"
  },
  "If-Then-Else-End": {
    "prefix": "ife",
    "body": [
      "if ${1:condition} then",
      "\t${2:# true branch}",
      "else",
      "\t${3:# false branch}",
      "end"
    ],
    "description": "If-else statement"
  },
  "If-Else-If-End": {
    "prefix": "ifeif",
    "body": [
      "if ${1:condition1} then",
      "\t${2:# first branch}",
      "elseif ${3:condition2} then",
      "\t${4:# second branch}",
      "else",
      "\t${5:# default branch}",
      "end"
    ],
    "description": "If-else-if statement"
  },
  "Elseif Clause": {
    "prefix": "elseif",
    "body": [
      "elseif ${1:condition} then",
      "\t$0"
    ],
    "description": "Elseif clause for existing if statement"
  },
  "While Loop": {
    "prefix": "while",
    "body": [
      "while ${1:condition} do",
      "\t$0",
      "end"
    ],
    "description": "While loop"
  },
  "Foreach Loop": {
    "prefix": "foreach",
    "body": [
      "foreach ${1:item} in ${2:array} do",
      "\t$0",
      "end"
    ],
    "description": "Foreach loop"
  },
  "Foreach with Data": {
    "prefix": "foreachdata",
    "body": [
      "foreach ${1:item} in Data.${2:items} do",
      "\t$0",
      "end"
    ],
    "description": "Foreach loop over Data property"
  },
  "Switch Statement": {
    "prefix": "switch",
    "body": [
      "switch ${1:expression} do",
      "\tcase ${2:value1} then",
      "\t\t${3:# case 1}",
      "\tcase ${4:value2} then",
      "\t\t${5:# case 2}",
      "\tdefault then",
      "\t\t${6:# default}",
      "end"
    ],
    "description": "Switch statement"
  },
  "Ternary Operator": {
    "prefix": "tern",
    "body": [
      "${1:condition} ? ${2:trueValue} : ${3:falseValue}"
    ],
    "description": "Ternary conditional operator"
  },
  "Array Literal": {
    "prefix": "arr",
    "body": [
      "[${1:}]"
    ],
    "description": "Array literal"
  },
  "Object Literal": {
    "prefix": "obj",
    "body": [
      "{ ${1:\"key\"}: ${2:value} }"
    ],
    "description": "Object literal"
  },
  "Filter Array": {
    "prefix": "filter",
    "body": [
      "Filter(${1:array}, \"${2:field}\", \"${3|==,!=,<,>,<=,>=|}\", ${4:value})"
    ],
    "description": "Filter array by field condition"
  },
  "Sort Array": {
    "prefix": "sort",
    "body": [
      "SortByField(${1:array}, \"${2:field}\", \"${3|asc,desc|}\")"
    ],
    "description": "Sort array by field"
  },
  "Date Add": {
    "prefix": "dateadd",
    "body": [
      "DateAdd(${1:date}, ${2:amount}, \"${3|days,weeks,months,years,hours,minutes,seconds|}\")"
    ],
    "description": "Add time to a date"
  },
  "Date Diff": {
    "prefix": "datediff",
    "body": [
      "DateDiff(${1:endDate}, ${2:startDate}, \"${3|days,weeks,months,years,hours,minutes,seconds|}\")"
    ],
    "description": "Calculate difference between dates"
  },
  "Data Assignment": {
    "prefix": "data",
    "body": [
      "Data.${1:property} = ${2:value}"
    ],
    "description": "Assign to Data property"
  },
  "Data Access": {
    "prefix": "dataget",
    "body": [
      "Data.${1:property}"
    ],
    "description": "Access Data property"
  },
  "String Upper": {
    "prefix": "upper",
    "body": [
      "Upper(${1:string})"
    ],
    "description": "Convert string to uppercase"
  },
  "String Lower": {
    "prefix": "lower",
    "body": [
      "Lower(${1:string})"
    ],
    "description": "Convert string to lowercase"
  },
  "String Split": {
    "prefix": "split",
    "body": [
      "Split(${1:string}, \"${2:delimiter}\")"
    ],
    "description": "Split string into array"
  },
  "String Join": {
    "prefix": "join",
    "body": [
      "Join(${1:array}, \"${2:separator}\")"
    ],
    "description": "Join array into string"
  },
  "Array Append": {
    "prefix": "append",
    "body": [
      "Append(${1:array}, ${2:value})"
    ],
    "description": "Append value to array"
  },
  "Array Length": {
    "prefix": "length",
    "body": [
      "Length(${1:array})"
    ],
    "description": "Get array length"
  },
  "Now Timestamp": {
    "prefix": "now",
    "body": [
      "Now()"
    ],
    "description": "Get current UTC timestamp"
  },
  "Today Date": {
    "prefix": "today",
    "body": [
      "Today()"
    ],
    "description": "Get current UTC date at midnight"
  },
  "TypeOf Check": {
    "prefix": "typeof",
    "body": [
      "TypeOf(${1:value})"
    ],
    "description": "Get type of value"
  },
  "Null Check": {
    "prefix": "isnull",
    "body": [
      "IsNull(${1:value})"
    ],
    "description": "Check if value is null"
  },
  "Exists Check": {
    "prefix": "exists",
    "body": [
      "Exists(${1:value})"
    ],
    "description": "Check if value is not null"
  },
  "Return": {
    "prefix": "return",
    "body": [
      "return"
    ],
    "description": "Return from the script"
  },
  "Return with Value": {
    "prefix": "returnm",
    "body": [
      "return ${1:value}"
    ],
    "description": "Return from the script with a value"
  },
  "Fail": {
    "prefix": "fail",
    "body": [
      "fail"
    ],
    "description": "Fail script execution"
  },
  "Fail with Message": {
    "prefix": "failm",
    "body": [
      "fail \"${1:error message}\""
    ],
    "description": "Fail script execution with an error message"
  },
  "Any": {
    "prefix": "any",
    "body": [
      "Any(${1:array}, \"${2:field}\", \"${3|==,!=,<,>,<=,>=|}\", ${4:value})"
    ],
    "description": "Check if any element matches condition"
  },
  "All": {
    "prefix": "all",
    "body": [
      "All(${1:array}, \"${2:field}\", \"${3|==,!=,<,>,<=,>=|}\", ${4:value})"
    ],
    "description": "Check if all elements match condition"
  },
  "Find": {
    "prefix": "find",
    "body": [
      "Find(${1:array}, \"${2:field}\", \"${3|==,!=,<,>,<=,>=|}\", ${4:value})"
    ],
    "description": "Find first matching element"
  },
  "Merge Objects": {
    "prefix": "merge",
    "body": [
      "Merge(${1:object1}, ${2:object2})"
    ],
    "description": "Merge objects (later overrides earlier)"
  },
  "Regex Match": {
    "prefix": "regexmatch",
    "body": [
      "RegexMatch(${1:text}, \"${2:pattern}\")"
    ],
    "description": "Extract first regex match as string"
  },
  "Regex Match All": {
    "prefix": "regexmatchall",
    "body": [
      "RegexMatchAll(${1:text}, \"${2:pattern}\")"
    ],
    "description": "Extract all regex matches as array"
  },
  "Regex Test": {
    "prefix": "regextest",
    "body": [
      "RegexTest(${1:text}, \"${2:pattern}\")"
    ],
    "description": "Test if pattern matches text"
  },
  "Regex Match Detail": {
    "prefix": "regexmatchdetail",
    "body": [
      "RegexMatchDetail(${1:text}, \"${2:pattern}\")"
    ],
    "description": "Extract first match with metadata (index, groups)"
  }
}
